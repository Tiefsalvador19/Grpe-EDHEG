<!doctype html>
<html lang="fr">
<head>
Â  <meta charset="utf-8">
Â  <meta name="viewport" content="width=device-width, initial-scale=1">
Â  <title>Ouraga Ange-Michel â€” Campagne EDHEG : Leader, Action, Innovation</title>
Â  Â  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
Â  Â  <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">
Â  Â  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

Â  <style>
Â  Â  /* CSS pour un look chic et percutant */
Â  Â  :root{
Â  Â  Â  --primary:#0d6efd; /* Bleu dominant */
Â  Â  Â  --accent:#ff7a00; /* Orange percutant */
Â  Â  Â  --muted:#6c757d;
Â  Â  Â  --glass: rgba(255,255,255,0.85); /* Plus opaque */
Â  Â  }
Â  Â  body{background: linear-gradient(180deg,#f6f9ff 0%, #ffffff 100%); color:#222}
Â  Â  .hero{background: linear-gradient(90deg, rgba(13,110,253,0.08), rgba(255,122,0,0.05)); padding:7rem 0} /* Plus d'espace */
Â  Â  .card-ghost{background:var(--glass); backdrop-filter: blur(8px); border:1px solid rgba(0,0,0,0.05); border-radius:1rem; transition: transform 0.2s ease, box-shadow 0.2s ease;}
    .card-ghost:hover { box-shadow: 0 8px 30px rgba(13,110,253,0.1); transform: translateY(-3px); }
Â  Â  .nav-brand{font-weight:800; letter-spacing:.5px; font-size: 1.5rem;}
Â  Â  .cta-btn{background:var(--primary); color:#fff}
Â  Â  .btn-animate:hover{transform:translateY(-4px); transition:all .25s ease}
Â  Â  
Â  Â  /* Styles de la section Statistique */
Â  Â  .stat-box{padding:25px; text-align:center; background:#fff; border-radius:12px; box-shadow:0 8px 25px rgba(0,0,0,0.08); min-height: 400px;} /* Ombre plus marquÃ©e */
Â  Â  .stat-number{font-size:3.5rem; font-weight:800; color:var(--accent); line-height: 1.2;}
Â  Â  .stat-error{background-color:#f8d7da; color:#721c24; border:1px solid #f5c6cb; padding:15px; border-radius:5px; margin-bottom:20px; font-weight: bold;}
Â  Â  .table-responsive{max-height: 220px; overflow-y: auto; text-align: left;}Â 

    /* --- NOUVEAUX STYLES POUR AMÃ‰LIORER LE RENDU --- */
    /* Correction de l'image de profil */
    .profile-photo {
        position: relative;
        display: inline-block;
        /* Ombre douce */
        box-shadow: 0 15px 50px rgba(13,110,253,0.2); 
        border-radius: 1rem;
        overflow: hidden; 
    }
    .profile-photo img {
        display: block;
        max-width: 100%;
        height: auto;
    }
    .alt-overlay {
        position: absolute; 
        opacity: 0;
        visibility: hidden;
    }
    .hero-img{max-width:480px; width:100%;}
    
    /* Style pour les blocs programme */
    .pill {
        display: inline-block;
        padding: 6px 15px;
        border-radius: 50px;
        font-size: 0.95rem;
        font-weight: 700;
        color: #fff;
        margin-bottom: 15px;
    }
    .pill i {
        margin-right: 8px;
        font-size: 1.1rem;
    }
    .program-card {
        transition: transform 0.3s ease;
        border: none;
        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        border-radius: 12px;
    }
    .program-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    .program-card h5 {
        color: var(--primary); 
        font-weight: 800;
        margin-top: 10px;
        font-size: 1.4rem;
    }
Â  </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top py-3">
Â  <div class="container">
Â  Â  <a class="navbar-brand nav-brand" href="#">ANGE-MICHEL | EDHEG</a>
Â  Â  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu">
Â  Â  Â  <span class="navbar-toggler-icon"></span>
Â  Â  </button>
Â  Â  <div class="collapse navbar-collapse" id="navMenu">
Â  Â  Â  <ul class="navbar-nav ms-auto align-items-lg-center">
Â  Â  Â  Â  <li class="nav-item"><a class="nav-link fw-bold" href="#about">Mon Parcours</a></li>
Â  Â  Â  Â  <li class="nav-item"><a class="nav-link fw-bold" href="#program">Programme SMART</a></li>
Â  Â  Â  Â  <li class="nav-item"><a class="nav-link fw-bold" href="#stats">Statistiques Live</a></li>
Â  Â  Â  Â  <li class="nav-item"><a class="nav-link fw-bold" href="#join">Soutenir / Rejoindre</a></li>
Â  Â  Â  Â  <li class="nav-item ms-3"><a class="btn btn-primary btn-animate fw-bold" href="#join">Voter / Soutenir</a></li>
Â  Â  Â  </ul>
Â  Â  </div>
Â  </div>
</nav>

<section class="hero">
Â  <div class="container">
Â  Â  <div class="row align-items-center">
Â  Â  Â  <div class="col-lg-6" data-aos="fade-right">
Â  Â  Â  Â  <h1 class="display-4 fw-bold mb-4">Un Leader, Une Vision : L'Action et l'Innovation.</h1>
Â  Â  Â  Â  <p class="lead text-muted">Ã‰tudiant IDEA, laurÃ©at ECOCIR, chef de projet. **Mon engagement :** transformer nos frustrations en opportunitÃ©s. Ensemble, faisons vivre notre Ã©cole !</p>
Â  Â  Â  Â  <div class="d-flex gap-3 mt-5">
Â  Â  Â  Â  Â  <a class="btn cta-btn btn-lg btn-animate fw-bold" href="#program">DÃ©couvrir le programme SMART</a>
Â  Â  Â  Â  Â  <a class="btn btn-outline-secondary btn-lg fw-bold" href="#join">Rejoindre l'Ã©quipe</a>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="mt-5">
Â  Â  Â  Â  Â  <div class="row g-3">
Â  Â  Â  Â  Â  Â  <div class="col-6">
Â  Â  Â  Â  Â  Â  Â  <div class="card p-3 card-ghost">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="d-flex align-items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-vote-yea fa-2x me-3" style="color:var(--primary)"></i>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small class="text-muted fw-bold">Total Soutiens (Live)</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="fw-bold fs-4" id="live-votes">0</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="col-6">
Â  Â  Â  Â  Â  Â  Â  <div class="card p-3 card-ghost">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="d-flex align-items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-users-gear fa-2x me-3" style="color:var(--accent)"></i>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small class="text-muted fw-bold">Ã‰quipe RecrutÃ©e (Live)</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="fw-bold fs-4" id="live-members">0</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â  <div class="col-lg-6 text-center" data-aos="fade-left">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="profile-photo mx-auto">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <img src="Images/ouraga.jpg" alt="Ouraga Ange-Michel, Leader EDHEG" class="hero-img">
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="alt-overlay">Ouraga Ange-Michel</div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>
</section>

<section id="program" class="py-5">
  <div class="container">
    <div class="text-center mb-5" data-aos="fade-up">
      <h2 class="display-6 fw-bold mb-3">Programme â€” 4 piliers SMART ðŸŽ¯</h2>
      <p class="lead text-muted">Des actions claires, mesurables et rÃ©alisables pour une EDHEG plus forte.</p>
    </div>

    <div class="row g-4">
      <div class="col-md-6 col-lg-3" data-aos="flip-up">
        <div class="card h-100 p-4 program-card">
          <div class="pill mb-3" style="background-color:var(--primary)"><i class="fa-solid fa-rss"></i> Communication</div>
          <h5>Hub EDHEG</h5>
          <p class="text-muted">Plateforme centralisÃ©e, rÃ©ponses **&lt;24h**, transparence totale.</p>
          <div class="mt-auto pt-3"><small class="text-muted fw-bold">KPI : -75% questions externes</small></div>
        </div>
      </div>

      <div class="col-md-6 col-lg-3" data-aos="flip-up" data-aos-delay="80">
        <div class="card h-100 p-4 program-card">
          <div class="pill mb-3" style="background-color:var(--accent)"><i class="fa-solid fa-hands-bubbles"></i> CohÃ©sion</div>
          <h5>Challenge Inter-FiliÃ¨res</h5>
          <p class="text-muted">Ã‰vÃ©nements, clubs, et journÃ©es de co-crÃ©ation.</p>
          <div class="mt-auto pt-3"><small class="text-muted fw-bold">KPI : +50% participation</small></div>
        </div>
      </div>

      <div class="col-md-6 col-lg-3" data-aos="flip-up" data-aos-delay="160">
        <div class="card h-100 p-4 program-card">
          <div class="pill mb-3" style="background-color:#198754"><i class="fa-solid fa-calendar-days"></i> Vie Ã‰tudiante</div> 
          <h5>Ateliers & Sorties</h5>
          <p class="text-muted">Ateliers mensuels, 2 sorties pÃ©dagogiques par semestre.</p>
          <div class="mt-auto pt-3"><small class="text-muted fw-bold">KPI : 40% d'engagement M2</small></div>
        </div>
      </div>

      <div class="col-md-6 col-lg-3" data-aos="flip-up" data-aos-delay="240">
        <div class="card h-100 p-4 program-card">
          <div class="pill mb-3" style="background-color:#dc3545"><i class="fa-solid fa-lightbulb"></i> Innovation</div> 
          <h5>Fonds & Mentorat (FIE)</h5>
          <p class="text-muted">Financer les projets Ã©tudiants et connecter aux pros.</p>
          <div class="mt-auto pt-3"><small class="text-muted fw-bold">KPI : financer 5 projets / semestre</small></div>
        </div>
      </div>
    </div>
  </div>
</section>
---

<section id="stats" class="py-5 bg-light">
Â  Â  <div class="container">
Â  Â  Â  Â  <div class="text-center mb-5" data-aos="fade-up">
Â  Â  Â  Â  Â  Â  <h2 class="display-6 fw-bold mb-3">Statistiques en Temps RÃ©el ðŸ“Š</h2>
Â  Â  Â  Â  Â  Â  <p class="lead text-muted">Transparence totale : soutiens et membres affichÃ©s en direct via notre Hub IDEA (Google Sheets & Apps Script).</p>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="stat-error d-none" id="fetch-error">
Â  Â  Â  Â  Â  Â  <i class="fas fa-exclamation-triangle me-2"></i> **ProblÃ¨me de connexion !** Impossible de charger les donnÃ©es. VÃ©rifiez vos URL Apps Script.
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="row g-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="col-lg-6">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-box h-100" data-aos="fade-up">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-vote-yea fa-3x text-primary mb-3"></i>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4>Soutien ReÃ§u (Votes)</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-number" id="total-votes-stat">0</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h5 class="mt-4 fw-bold">Derniers Soutiens (Motivation)</h5>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="table-responsive">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table class="table table-striped table-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Nom</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>FiliÃ¨re</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Motivation</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="votes-list-body">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr><td colspan="3">Chargement...</td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="col-lg-6">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-box h-100" data-aos="fade-up" data-aos-delay="100">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-users-gear fa-3x text-accent mb-3"></i>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h4>Membres Inscrits (Ã‰quipe)</h4>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-number" id="total-members-stat">0</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h5 class="mt-4 fw-bold">L'Ã‰quipe d'Action (Volontaires)</h5>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="table-responsive">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table class="table table-striped table-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>Nom</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>FiliÃ¨re</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th>RÃ´le</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="members-list-body">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr><td colspan="3">Chargement...</td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>
</section>

---

<section id="join" class="py-5">
Â  <div class="container">
Â  Â  <div class="row g-4 align-items-center">
Â  Â  Â  <div class="col-lg-6" data-aos="fade-up">
Â  Â  Â  Â  <h3 class="fw-bold">Rejoins l'Ã©quipe ou Soutiens ma vision !</h3>
Â  Â  Â  Â  <p class="lead text-muted">Deux faÃ§ons d'agir : voter symboliquement pour ma vision ou devenir un acteur du changement dans l'Ã©quipe.</p>
Â  Â  Â  </div>
Â  Â  Â  <div class="col-lg-6" data-aos="fade-left">
Â  Â  Â  Â  <div class="card p-4 shadow-lg border-0">
Â  Â  Â  Â  Â  <h5 class="fw-bold mb-3">Formulaire de Soutien / Recrutement</h5>
Â  Â  Â  Â  Â  <form id="joinForm">
Â  Â  Â  Â  Â  Â  <div class="mb-3">
Â  Â  Â  Â  Â  Â  Â  <label for="nom" class="form-label fw-bold">Nom complet</label>
Â  Â  Â  Â  Â  Â  Â  <input type="text" class="form-control" id="nom" name="Nom complet" required>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="mb-3">
Â  Â  Â  Â  Â  Â  Â  <label for="filiere" class="form-label fw-bold">FiliÃ¨re / Niveau (ex: IDEA L2, GESTION M1)</label>
Â  Â  Â  Â  Â  Â  Â  <input type="text" class="form-control" id="filiere" name="FiliÃ¨re / Niveau" required>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="mb-3">
Â  Â  Â  Â  Â  Â  Â  <label for="role" class="form-label fw-bold">Je veux...</label>
Â  Â  Â  Â  Â  Â  Â  <select class="form-select" id="role" name="RÃ´le SouhaitÃ©" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="" disabled selected>Choisir une option</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Vote/Soutien Simple">Voter / Apporter mon Soutien (Simple)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Membre Equipe Communication">Devenir Membre (Com. / RÃ©seaux)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Membre Equipe Evenementiel">Devenir Membre (Ã‰vÃ©nements / Logistique)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Membre Equipe Projets IDEA">Devenir Membre (Projets Tech / IDEA)</option>
Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="mb-3">
Â  Â  Â  Â  Â  Â  Â  <label for="motivation" class="form-label fw-bold">Votre motivation / Message de soutien (max 100 mots)</label>
Â  Â  Â  Â  Â  Â  Â  <textarea class="form-control" id="motivation" name="Votre motivation" rows="3" required></textarea>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <button class="btn btn-primary w-100 btn-lg btn-animate fw-bold" type="submit">Envoyer et Rejoindre le Mouvement</button>
Â  Â  Â  Â  Â  Â  <div id="form-message" class="mt-3 text-center d-none"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>
</section>

---

<footer class="bg-white border-top">
Â  <div class="container">
Â  Â  <div class="row align-items-center">
Â  Â  Â  <div class="col-md-6 py-3">
Â  Â  Â  Â  <small>Â© <strong>Ouraga Angeâ€‘Michel</strong> â€” Campagne EDHEG â€¢ Construit avec l'esprit IDEA</small>
Â  Â  Â  </div>
Â  Â  Â  <div class="col-md-6 text-md-end py-3">
Â  Â  Â  Â  <a href="#" class="me-3 text-muted"><i class="fa-brands fa-whatsapp fa-lg"></i></a>
Â  Â  Â  Â  <a href="#" class="me-3 text-muted"><i class="fa-brands fa-linkedin fa-lg"></i></a>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script>
Â  AOS.init({duration:800, once:true});

Â  // =================================================================
Â  // CONFIGURATION GAS API (MISES Ã€ JOUR)
Â  // =================================================================

Â  // URL pour soumettre les donnÃ©es (votre script GAS doPost - URL de l'image d0e3fa.png)
Â  const GAS_POST_URL = 'https://script.google.com/macros/s/AKfycbx8xCVGqbsDxDi115uBX7FVQe54OiQaBv872XIKMbL6XD4SRFrv0YR-2KXQrWM_80i-/exec';

Â  // URL pour rÃ©cupÃ©rer les donnÃ©es (votre script GAS unifiÃ© doGet - URL du dernier message utilisateur)
Â  const GAS_FETCH_URL = 'https://script.google.com/macros/s/AKfycbweqnr98zvtfi2NxV6Ow9YyNGuT-ECl1PCNRa_9rA-hzl_O3iz6slxHWRIfODmJIlq5XQ/exec';
Â Â 
Â  // NOTE: VÃ©rifiez que GAS_POST_URL pointe vers l'API qui Ã©crit les donnÃ©es
Â  // et GAS_FETCH_URL pointe vers l'API qui lit les donnÃ©es (celle corrigÃ©e en Code.gs).

Â  // =================================================================
Â  // LOGIQUE JAVASCRIPT DE RÃ‰CUPÃ‰RATION ET D'AFFICHAGE
Â  // =================================================================

Â  // Fonction 1 : RÃ©cupÃ©rer les donnÃ©es et mettre Ã  jour les statistiques
Â  async function fetchStats() {
Â  Â  Â  const errorDiv = document.getElementById('fetch-error');
Â  Â  Â  errorDiv.classList.add('d-none');
Â  Â  Â Â 
Â  Â  Â  try {
Â  Â  Â  Â  Â  // --- 1. RÃ‰CUPÃ‰RER LES VOTES/SOUTIENS (Feuille "Ã‰lection EDHEG") ---
Â  Â  Â  Â  Â  // Utilise le paramÃ¨tre ?sheet=votes pour cibler la bonne feuille dans votre script GAS unifiÃ©
Â  Â  Â  Â  Â  const votesResponse = await fetch(GAS_FETCH_URL + '?sheet=votes');Â 
Â  Â  Â  Â  Â  const votesData = await votesResponse.json();

Â  Â  Â  Â  Â  if (votesData.error) throw new Error(votesData.message);
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  const votes = votesData.rows || [];
Â  Â  Â  Â  Â  document.getElementById('live-votes').textContent = votes.length;
Â  Â  Â  Â  Â  document.getElementById('total-votes-stat').textContent = votes.length;
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  const votesBody = document.getElementById('votes-list-body');
Â  Â  Â  Â  Â  votesBody.innerHTML = '';
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  votes.slice(0, 10).forEach(item => {
Â  Â  Â  Â  Â  Â  Â  const row = votesBody.insertRow();
Â  Â  Â  Â  Â  Â  Â  // ATTENTION : Les clÃ©s JSON doivent correspondre aux en-tÃªtes exacts de votre feuille Sheets
Â  Â  Â  Â  Â  Â  Â  row.insertCell().textContent = item["Nom complet"] || 'Anonyme';Â 
Â  Â  Â  Â  Â  Â  Â  row.insertCell().textContent = item["FiliÃ¨re / Niveau"] || 'N/A';Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  row.insertCell().textContent = (item["Votre motivation"] || '').substring(0, 40) + '...';Â 
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  if (votes.length === 0) votesBody.innerHTML = '<tr><td colspan="3">Aucun soutien enregistrÃ© pour l\'instant.</td></tr>';

Â  Â  Â  Â  Â  // --- 2. RÃ‰CUPÃ‰RER LES MEMBRES DE L'Ã‰QUIPE (Feuille "Rejoindre l'Ã©quipe") ---
Â  Â  Â  Â  Â  // Utilise le paramÃ¨tre ?sheet=equipe
Â  Â  Â  Â  Â  const membersResponse = await fetch(GAS_FETCH_URL + '?sheet=equipe');Â 
Â  Â  Â  Â  Â  const membersData = await membersResponse.json();

Â  Â  Â  Â  Â  if (membersData.error) throw new Error(membersData.message);

Â  Â  Â  Â  Â  const members = membersData.rows || [];
Â  Â  Â  Â  Â  document.getElementById('live-members').textContent = members.length;
Â  Â  Â  Â  Â  document.getElementById('total-members-stat').textContent = members.length;
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  const membersBody = document.getElementById('members-list-body');
Â  Â  Â  Â  Â  membersBody.innerHTML = '';

Â  Â  Â  Â  Â  members.slice(0, 10).forEach(item => {
Â  Â  Â  Â  Â  Â  Â  const row = membersBody.insertRow();
Â  Â  Â  Â  Â  Â  Â  // ATTENTION : Les clÃ©s JSON doivent correspondre aux en-tÃªtes exacts de votre feuille Sheets
Â  Â  Â  Â  Â  Â  Â  row.insertCell().textContent = item["Nom complet"] || 'Anonyme';Â 
Â  Â  Â  Â  Â  Â  Â  row.insertCell().textContent = item["FiliÃ¨re / Niveau"] || 'N/A';Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  row.insertCell().textContent = item["RÃ´le SouhaitÃ©"] || 'Volontaire';Â 
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  if (members.length === 0) membersBody.innerHTML = '<tr><td colspan="3">Aucun membre actif enregistrÃ© pour l\'instant.</td></tr>';

Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  console.error('Erreur lors du chargement des statistiques:', error);
Â  Â  Â  Â  Â  errorDiv.classList.remove('d-none');
Â  Â  Â  Â  Â  document.getElementById('votes-list-body').innerHTML = '<tr><td colspan="3">Ã‰chec du chargement</td></tr>';
Â  Â  Â  Â  Â  document.getElementById('members-list-body').innerHTML = '<tr><td colspan="3">Ã‰chec du chargement</td></tr>';
Â  Â  Â  }
Â  }

Â  // Fonction 2 : Soumettre le formulaire (gestionnaire d'Ã©vÃ©nement)
Â  document.getElementById('joinForm').addEventListener('submit', async function(e) {
Â  Â  Â  e.preventDefault();
Â  Â  Â  const form = e.target;
Â  Â  Â  const formData = new FormData(form);
Â  Â  Â  const formMessage = document.getElementById('form-message');
Â  Â  Â Â 
Â  Â  Â  formData.append('action', 'post_data'); // Action pour le script POST GAS (ajustez si besoin)

Â  Â  Â  formMessage.classList.remove('d-none', 'text-success', 'text-danger');
Â  Â  Â  formMessage.classList.add('text-muted');
Â  Â  Â  formMessage.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Envoi en cours...';

Â  Â  Â  try {
Â  Â  Â  Â  Â  // NOTE: On utilise GAS_POST_URL pour l'envoi des donnÃ©es
Â  Â  Â  Â  Â  const response = await fetch(GAS_POST_URL, {
Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  body: formData,
Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  // Le script POST GAS doit retourner un JSON avec {status: "SUCCESS"}
Â  Â  Â  Â  Â  const result = await response.json();Â 

Â  Â  Â  Â  Â  if (result.status === 'SUCCESS') {
Â  Â  Â  Â  Â  Â  Â  formMessage.classList.remove('text-muted');
Â  Â  Â  Â  Â  Â  Â  formMessage.classList.add('text-success');
Â  Â  Â  Â  Â  Â  Â  formMessage.innerHTML = '<i class="fas fa-check-circle me-2"></i> Merci pour votre soutien et/ou votre engagement !';
Â  Â  Â  Â  Â  Â  Â  form.reset();
Â  Â  Â  Â  Â  Â  Â  fetchStats(); // Actualiser les stats aprÃ¨s la soumission
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  throw new Error(result.message || 'Erreur inconnue du serveur GAS.');
Â  Â  Â  Â  Â  }

Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  console.error('Erreur de soumission:', error);
Â  Â  Â  Â  Â  formMessage.classList.remove('text-muted');
Â  Â  Â  Â  Â  formMessage.classList.add('text-danger');
Â  Â  Â  Â  Â  formMessage.innerHTML = `<i class="fas fa-times-circle me-2"></i> Ã‰chec de l'envoi. ${error.message}`;
Â  Â  Â  }
Â  });

Â  // Charger les statistiques au dÃ©marrage et les rafraÃ®chir
Â  document.addEventListener('DOMContentLoaded', fetchStats);
Â  setInterval(fetchStats, 30000); // RafraÃ®chir toutes les 30 secondes pour le "live"

</script>
</body>
</html>
